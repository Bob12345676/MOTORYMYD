# Инструкции по деплою на Render

## Подготовка к деплою

Перед деплоем убедитесь, что:

1. У вас есть аккаунт на [Render](https://render.com/)
2. У вас есть аккаунт на [MongoDB Atlas](https://www.mongodb.com/cloud/atlas) с созданным кластером
3. У вас есть аккаунт на [AWS](https://aws.amazon.com) для хранения изображений в S3 (или вы можете использовать альтернативу, например Cloudinary)

## Настройка MongoDB Atlas

1. Создайте новый кластер в MongoDB Atlas
2. Настройте доступ к базе данных (создайте пользователя и пароль)
3. Добавьте IP адрес 0.0.0.0/0 в список разрешенных для подключения (для разработки, в продакшне лучше ограничить)
4. Получите строку подключения MongoDB (Connection String)

## Настройка AWS S3

1. Создайте новый бакет в AWS S3
2. Настройте политику CORS для бакета, чтобы разрешить загрузку с вашего домена
3. Создайте IAM пользователя с доступом к S3
4. Получите ключи доступа (Access Key ID и Secret Access Key)

## Деплой бэкенда на Render

1. Войдите в аккаунт Render
2. Нажмите на кнопку "New" и выберите "Web Service"
3. Подключите свой репозиторий GitHub
4. Укажите имя сервиса, например "motory-api"
5. Выберите ветку для деплоя (обычно main или master)
6. Укажите корневую директорию: `server`
7. Выберите среду Node
8. Укажите команду сборки: `npm install`
9. Укажите команду запуска: `npm start`
10. Выберите тип плана (Free или Starter)
11. Добавьте переменные окружения:
    - `NODE_ENV=production`
    - `PORT=8080`
    - `MONGODB_URI=<your-mongodb-connection-string>`
    - `JWT_SECRET=<your-jwt-secret>`
    - `AWS_ACCESS_KEY_ID=<your-aws-access-key-id>`
    - `AWS_SECRET_ACCESS_KEY=<your-aws-secret-access-key>`
    - `AWS_REGION=<your-aws-region>`
    - `AWS_BUCKET_NAME=<your-aws-bucket-name>`
    - `CORS_ORIGIN=<your-frontend-url>`
12. Нажмите "Create Web Service"

## Деплой фронтенда на Render

1. Войдите в аккаунт Render
2. Нажмите на кнопку "New" и выберите "Static Site"
3. Подключите свой репозиторий GitHub
4. Укажите имя сервиса, например "motory-frontend"
5. Выберите ветку для деплоя (обычно main или master)
6. Укажите корневую директорию: `client`
7. Укажите команду сборки: `npm install && npm run build`
8. Укажите директорию публикации: `build`
9. Добавьте переменные окружения:
    - `REACT_APP_API_URL=<your-backend-url>`
10. Нажмите "Create Static Site"

## Настройка домена (опционально)

1. В настройках сервиса Render перейдите в раздел "Settings" > "Custom Domain"
2. Следуйте инструкциям для настройки вашего домена

## Проверка деплоя

1. После успешного деплоя проверьте работоспособность API по URL бэкенда
2. Проверьте работоспособность фронтенда по URL статического сайта
3. Проверьте корректность работы авторизации и загрузки изображений

## Наблюдение и масштабирование

Render предоставляет встроенные инструменты мониторинга и логирования. Для просмотра логов:

1. Перейдите на страницу вашего сервиса
2. Перейдите во вкладку "Logs"

Для масштабирования:

1. Перейдите в настройки сервиса
2. Измените тип плана на более производительный 